{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Seja Bem Vindo","text":"<p> LinkedIn / GitHub</p>  Ol\u00e1!   Meu nome \u00e9 Pedro, sou um entusiasta da tecnologia e adoro estudar a sociedade e seus padr\u00f5es. Este \u00e9 um projeto que desenvolvi por hobby.    O objetivo deste projeto \u00e9 colocar em pr\u00e1tica todas as etapas de um processo de dados. Pretendo passar pelas etapas de extra\u00e7\u00e3o, tratamento e an\u00e1lise de dados, destacando pontos altos e baixos da base de modo a ser aplic\u00e1vel em variados tipos de neg\u00f3cios. Em seguida, pretendo elaborar um modelo, coloc\u00e1-lo em produ\u00e7\u00e3o, monitor\u00e1-lo e, n\u00e3o menos importante, documentar todo o processo.    Nome oficial do Projeto: Projeto extraindo valor dos dados da Receita Federal"},{"location":"CNPJ/","title":"Sobre CNPJ","text":""},{"location":"CNPJ/#o-que-e","title":"O que \u00e9?","text":"O Cadastro Nacional da Pessoa Jur\u00eddica, amplamente reconhecido pela sigla CNPJ, foi institu\u00eddo em julho de 1998. Esse cadastro foi criado com a finalidade de registrar, organizar e identificar todas as Pessoas Jur\u00eddicas (PJ) que operam no Brasil e que possuem obriga\u00e7\u00f5es junto \u00e0 Receita Federal Brasileira (RFB).   De acordo com a Receita Federal, o CNPJ \u00e9 \"um banco de dados administrado pela RFB, que armazena informa\u00e7\u00f5es cadastrais das Pessoas Jur\u00eddicas e outras entidades, sendo de interesse das administra\u00e7\u00f5es tribut\u00e1rias da Uni\u00e3o, dos Estados, do Distrito Federal e dos Munic\u00edpios\". Isso significa que qualquer empreendedor ou empres\u00e1rio que deseje atuar legalmente no mercado brasileiro, oferecendo produtos ou servi\u00e7os e emitindo notas fiscais, precisa registrar sua empresa e obter um CNPJ.    O n\u00famero do CNPJ \u00e9 composto por 14 d\u00edgitos formatados da seguinte maneira: AA.AAA.AAA/BBBB-CC. Os oito primeiros d\u00edgitos (representados pelas letras 'A') formam a base ou raiz do CNPJ, identificando a empresa em si. Os pr\u00f3ximos quatro d\u00edgitos (representados pelas letras 'B') distinguem se a unidade \u00e9 a matriz ou uma filial da empresa. Os dois \u00faltimos d\u00edgitos (representados pelas letras 'C') atuam como d\u00edgitos verificadores, garantindo a autenticidade do n\u00famero.  <p>Resumo</p> <ul> <li> Fonte de dados: Receita Federal Brasileira;</li> <li> M\u00e9todo de coleta do RFB: Toda empresa que busca estar legalizada no pa\u00eds tem a obrigatoriedade de se cadastrar junto \u00e0 RFB;</li> <li> M\u00e9todo de coleta: Dados disponibilizados pela Receita Federal Brasileira;</li> <li> Tratamento de dados: Pedro Almeida</li> <li> Periodicidade: Os dados s\u00e3o atualizados mensalmente;</li> <li> Abrang\u00eancia: Nacional (Brasil), portanto, as an\u00e1lises podem ser feitas em granularidade de municipio. </li> <li> T\u00e9cnica de Investiga\u00e7\u00e3o: Censit\u00e1ria;</li> </ul> <p></p> Curiosidade: o que \u00e9 MEI? <p> O Microempreendedor Individual (MEI), classifica\u00e7\u00e3o criada em 2009, tem o prop\u00f3sito de regularizar uma pessoa que trabalha por conta pr\u00f3pria, ou seja, um profissional aut\u00f4nomo que precisa emitir nota fiscal, ou ter facilidades para conseguir um empr\u00e9stimo ou at\u00e9 mesmo para abrir uma conta banc\u00e1ria. Ao criar um MEI, o profissional aut\u00f4nomo passa a ter um registro de CNPJ e a ter acesso a benef\u00edcios da Previd\u00eancia Social. </p>"},{"location":"CNPJ/#emissao-do-cnpj","title":"Emiss\u00e3o do CNPJ","text":"Quem precisa dele?O que \u00e9 informado no cadastro?Modelo de ficha    Cadastral de CNPJ <p> Sindicatos;</p> <p> Condom\u00ednios;</p> <p> Associa\u00e7\u00f5es;</p> <p> ONGs (Organiza\u00e7\u00f5es n\u00e3o governamentais);</p> <p> Igrejas;</p> <p> Partidos pol\u00edticos;</p> <p> Empresas e org\u00e3os p\u00fablicos;</p> <p> Aut\u00f4nomos.</p> <p> N\u00famero de inscri\u00e7\u00e3o;</p> <p> Nome empresarial;</p> <p> Composi\u00e7\u00e3o societ\u00e1ria;</p> <p> Endere\u00e7o;</p> <p> Data de abertura;</p> <p> Natureza jur\u00eddica;</p> <p> Atividade econ\u00f4mica;</p> <p> Se existente, atividade econ\u00f4mica secund\u00e1ria;</p> <p> Situa\u00e7\u00e3o cadastral;</p> <p> C\u00f3digo e descri\u00e7\u00e3o do estatuto jur\u00eddico;</p> <p> Outros.</p> <p></p>"},{"location":"CNPJ/#porte","title":"Porte","text":"<p>Ao se falar de porte de uma empresa, n\u00e3o estamos tratando somente do capital financeiro que a pessoa jur\u00eddica possui, mas tamb\u00e9m do espa\u00e7o f\u00edsico ou n\u00famero de funcion\u00e1rios. Atualmente existem cinco categorias de portes de empresa, s\u00e3o elas:</p> <ul> <li>Microempreendedor Individual (MEI);</li> <li>Microempresa (ME);</li> <li>Empresa de Pequeno Porte (EPP);</li> <li>Empresa de M\u00e9dio Porte;</li> <li>Grande Empresa.</li> </ul> MEIMEEPPM\u00e9dio PorteGrande Porte <p>O Microempreendedor Individual \u00e9 um porte de empresa para abarcar atividades com faturamento at\u00e9 R$81 mil por ano \u2013 \u00e9 tamb\u00e9m o menor tipo de empresa dispon\u00edvel no Brasil. S\u00f3 \u00e9 permitido contratar apenas um colaborador e pagando, no m\u00e1ximo, o teto da categoria, neste modelo.</p> <p>O porte de Microempresa, por classifica\u00e7\u00e3o de faturamento conforme o Estatuto Nacional da Microempresa e da Empresa de Pequeno Porte, Lei Complementar 123, de 2006, permite atingir at\u00e9 R$360 mil por ano. Uma microempresa pode ter at\u00e9 20 funcion\u00e1rios.</p> <p>Pela mesma classifica\u00e7\u00e3o do Estatuto, uma Empresa de Pequeno Porte pode faturar at\u00e9 R$4,8 milh\u00f5es por ano. Este formato pode ter at\u00e9 100 funcion\u00e1rios.</p> <p>Esse tipo de classifica\u00e7\u00e3o pode oscilar de uma \u00e1rea para outra, mas geralmente o faturamento est\u00e1 em torno de R$ 4,8 milh\u00f5es e menor ou igual a R$ 300 milh\u00f5es. Na ind\u00fastria, o n\u00famero de funcion\u00e1rios para ser categorizado como m\u00e9dio porte \u00e9 de 100 a 499 empregados. J\u00e1 n\u00e1 \u00e1rea de com\u00e9rcio e servi\u00e7os, \u00e9 em torno de 50 a 99 empregados. </p> <p>Por fim, uma empresa \u00e9 categorizada como grande porte quando seu faturamento atinge valores superiores a R$ 300 milh\u00f5es. E o n\u00famero de empregados geralmente \u00e9 superior a 500 funcion\u00e1rios na ind\u00fastria, j\u00e1 em com\u00e9rcio e servi\u00e7os \u00e9 superior a 100 empregados.  </p>"},{"location":"CNPJ/#classificacao-nacional-de-atividades-economicas-cnae","title":"Classifica\u00e7\u00e3o Nacional de Atividades Econ\u00f4micas - CNAE","text":"A CNAE (Classifica\u00e7\u00e3o Nacional de Atividades Econ\u00f4micas) \u00e9 o instrumento de padroniza\u00e7\u00e3o nacional dos c\u00f3digos de atividade econ\u00f4mica e dos crit\u00e9rios de enquadramento utilizados pelos diversos \u00f3rg\u00e3os da Administra\u00e7\u00e3o Tribut\u00e1ria do pa\u00eds.    Trata-se de uma informa\u00e7\u00e3o cadastral obrigat\u00f3ria a todos os engajados na produ\u00e7\u00e3o de bens e servi\u00e7os, podendo compreender estabelecimentos de empresas privadas ou p\u00fablicas, estabelecimentos agr\u00edcolas, organismos p\u00fablicos e privados, institui\u00e7\u00f5es sem fins lucrativos e agentes aut\u00f4nomos (pessoa f\u00edsica).  <p>CNAE na base do CNPJ</p> <p>Na base do CNPJ, o CNAE permite o acesso a, ou a compara\u00e7\u00e3o das empresas de ramos de atividade espec\u00edficos, havendo a possibilidade de analisar o ramo de atividade principal e tamb\u00e9m os secund\u00e1rios.</p> <p></p> <p>Categorias do CNAE:</p> <p>Dicion\u00e1rio CNAE</p>"},{"location":"CNPJ/#situacao-cadastral-de-um-cnpj","title":"Situa\u00e7\u00e3o Cadastral de um CNPJ","text":"A \"situa\u00e7\u00e3o cadastral\" \u00e9 a informa\u00e7\u00e3o constante no CNPJ que identifica o status, a condi\u00e7\u00e3o atual da pessoa jur\u00eddica. A primeira delas \u00e9 ativa, a segunda inapta , a terceira situa\u00e7\u00e3o cadastral de um CNPJ \u00e9 suspensa, a quarta classifica\u00e7\u00e3o cadastral de CNPJ \u00e9 baixada, por fim, nula.  AtivaInaptaSuspensaBaixadaNula <p>Identifica aquelas entidades ou estabelecimentos que est\u00e3o regulares e em funcionamento (ou tamb\u00e9m quando n\u00e3o se enquadram em nenhuma das quatro op\u00e7\u00f5es seguintes).</p> <p>Identifica organiza\u00e7\u00f5es que est\u00e3o inadimplentes em suas responsabilidades fiscais ou legais por dois exerc\u00edcios.</p> <p>a) solicitar baixa de inscri\u00e7\u00e3o, estando esta solicita\u00e7\u00e3o em an\u00e1lise ou tendo sido indeferida; b) estiver em processo de declara\u00e7\u00e3o de inaptid\u00e3o por irregularidades fiscais ou legais; c) interromper temporariamente suas atividades, mediante solicita\u00e7\u00e3o; d) apresentar ind\u00edcio de atitude fraudulenta de s\u00f3cio ou titular. </p> <p>Identifica quando a Pessoa Jur\u00eddica realiza pedido de baixa, sendo deferido.</p> <p>a) Quando \u00e9 atribu\u00eddo mais de um n\u00famero de inscri\u00e7\u00e3o para o mesmo estabelecimento; b) Se constatado v\u00edcio em alguma a\u00e7\u00e3o praticada com aquele CNPJ; c) Se for constatado ato de inscri\u00e7\u00e3o relativo \u00e0 entidade que n\u00e3o atenda aos requisitos de inscri\u00e7\u00e3o no CNPJ. </p>"},{"location":"CNPJ/#motivo-de-situacao-cadastral","title":"Motivo de Situa\u00e7\u00e3o Cadastral","text":"A fim de compreender melhor a situa\u00e7\u00e3o cadastral, a Receita Federal Brasileira criou 68 categorias de motivo de situa\u00e7\u00e3o cadastral que d\u00e3o mais detalhes sobre cada tipo.  Motivo de Situa\u00e7\u00e3o Cadastral C\u00f3digo Motivo de Situa\u00e7\u00e3o Cadastral 1 Extin\u00e7\u00e3o por Encerramento, Liquida\u00e7\u00e3o Volunt\u00e1ria 2 Incorpora\u00e7\u00e3o 3 Fus\u00e3o 4 Cis\u00e3o Total 5 Encerramento da Fal\u00eancia 6 Encerramento da Liquida\u00e7\u00e3o 7 Eleva\u00e7\u00e3o a Matriz 8 Transpasse 9 N\u00e3o In\u00edcio de Atividade 10 Extin\u00e7\u00e3o pelo Encerramento da Liquida\u00e7\u00e3o Judicial 11 Anula\u00e7\u00e3o por Multiplicidade 12 Anula\u00e7\u00e3o Online de Of\u00edcio 13 Omiss\u00e3o Contumaz 14 Omiss\u00e3o N\u00e3o Localizada 15 Inexistente de Fato 16 Anula\u00e7\u00e3o por V\u00edcios 17 Baixa Iniciada e Ainda N\u00e3o Deferida 18 Interrup\u00e7\u00e3o Tempor\u00e1ria das Atividades 19 Omisso De DIRPJ at\u00e9 5 Exerc\u00edcios 20 Em Condi\u00e7\u00e3o de Inaptid\u00e3o 21 Pedido de Baixa Indeferida 22 Restabelecimento com Certid\u00e3o Positiva com Efeito de Negativa 23 Com Pend\u00eancia Fiscal 24 Por Emiss\u00e3o de Certid\u00e3o Negativa 25 Certid\u00e3o Positiva Com Efeito de Negativa 26 Irregularidade de Pagamento 27 Irregularidade de Recolhimento e Exigibilidade Suspensa 28 Transfer\u00eancia Filial Condi\u00e7\u00e3o Matriz 29 Aguardando Confer\u00eancia de DIRPJ/DIPJ 30 ANR - Aguardando Confer\u00eancia De DIRPJ/DIPJ 31 Extin\u00e7\u00e3o da Filial 32 Inexistente de Fato ADE/Cosar 33 Transfer\u00eancia do \u00d3rg\u00e3o Local a Condi\u00e7\u00e3o de Filial do \u00d3rg\u00e3o Regional 34 Anula\u00e7\u00e3o de Inscri\u00e7\u00e3o Indevida 35 Empresa Estrangeira Aguardando Documenta\u00e7\u00e3o 36 Pr\u00e1tica Irregular de Opera\u00e7\u00e3o de Com\u00e9rcio Exterior 37 Baixa de Produtor Rural 38 Baixa Deferida pela RFB Aguardando An\u00e1lise do Convenente 39 Baixa Deferida pela RFB e Indeferida Pelo Convenente 40 Baixa Indeferida pela RFB e Aguardando An\u00e1lise do Convenente 41 Baixa Indeferida pela RFB e Deferida Pelo Convenente 42 Baixa Indeferida pela RFB e Sefin 43 Baixa Deferida pela RFB 44 Baixa Deferida pela RFB e Sefaz 45 Baixa Deferida pela RFB 46 Baixa Deferida pela RFB e Sefaz e Indeferida pela Sefin 47 Baixa Deferida pela RFB e Sefin e Indeferida pela Sefaz 48 Baixa Indeferida pela RFB 49 Baixa Indeferida pela RFB 50 Baixa Indeferida pela RFB 51 Baixa Indeferida pela RFB e Sefaz 52 Baixa Indeferida pela RFB 53 Baixa Indeferida pela RFB e Sefaz e Deferida pela Sefin 54 Baixa - Tratamento Diferenciado Dado \u00e0s ME e EPP (Lei Complementar N\u00famero 123/2006) 55 Deferido Pelo Convenente 56 Artigo 30 57 Ind\u00edcio Interposi\u00e7\u00e3o Fraudulenta 58 Falta de Pluralidade de S\u00f3cios 59 Omiss\u00e3o de Declara\u00e7\u00f5es 60 Localiza\u00e7\u00e3o Desconhecida 61 Inaptid\u00e3o 62 Registro Cancelado 63 Anula\u00e7\u00e3o por N\u00e3o Confirmado Ato de Registro do MEI na Junta Comercial 64 Inaptid\u00e3o (Lei 11.941/2009 Art.54) 65 Determina\u00e7\u00e3o Judicial 66 Omiss\u00e3o Contumaz 67 Inconsist\u00eancia Cadastral 68 Baixa Registrada na Junta"},{"location":"CNPJ/#o-que-e-possivel-saber-com-a-base-cnpj","title":"O que \u00e9 poss\u00edvel saber com a base CNPJ?","text":"Quais as informa\u00e7\u00f5es s\u00e3o e n\u00e3o poss\u00edveis saber com a base CNPJ? \u00c9 poss\u00edvel saber Localiza\u00e7\u00e3o <ul> <li>Rua/Avenida;</li> <li>Bairro;</li> <li>N\u00famero do im\u00f3vel;</li> <li>Cidade;</li> <li>Estado;</li> <li>Pa\u00eds;</li> <li>CEP;</li> <li>Latitude e Longitude</li> </ul> Contato <ul> <li>E-mail;</li> <li>Telefone;</li> </ul> S\u00f3cio <ul> <li>Nome;</li> <li>CPF;</li> <li>Data de Entrada na Sociedade;</li> <li>Faixa et\u00e1ria.</li> <li>Sexo</li> </ul> MEI <ul> <li>Nome;</li> <li>CPF_CRIPTOGRAFADO;</li> <li>Sexo</li> </ul> Empresa <ul> <li>Nome da Empresa;</li> <li>Se \u00e9 matriz ou filial;</li> <li>Situa\u00e7\u00e3o Cadastral;</li> <li>Atividade econ\u00f4mica;</li> <li>Capital Social;</li> <li>Porte;</li> <li>Data de Abertura;</li> <li>Data de Cadastro;</li> <li>Setor de Atua\u00e7\u00e3o.</li> </ul>"},{"location":"CNPJ/#potencialidades-e-limitacoes","title":"Potencialidades e Limita\u00e7\u00f5es","text":"<p>Potencialidades</p> <ul> <li> Os dados disponibilizados s\u00e3o referentes \u00e0 totalidade dos CNPJs cadastrados no territ\u00f3rio brasileiro;</li> <li> Enriquecimento ou valida\u00e7\u00e3o de dados;  </li> <li> Principais dimens\u00f5es anal\u00edticas: Data de Registro, Informa\u00e7\u00f5es de s\u00f3cios (data de entrada, CPF, nome,...), capital social, localiza\u00e7\u00e3o, nome fantasia, situa\u00e7\u00e3o do CNPJ, natureza juridica;</li> <li> Identificar s\u00f3cios e empresas;</li> </ul> <p>Limita\u00e7\u00f5es</p> <p> N\u00e3o possui dimens\u00f5es relacionadas a faturamento, n\u00famero de funcion\u00e1rios, faixa salarial;</p>"},{"location":"analise_mei/","title":"An\u00e1lise de dados do MEI","text":"O Microempreendedor Individual (MEI) \u00e9 uma pessoa jur\u00eddica no Brasil voltada para aut\u00f4nomos e outros pequenos empreendedores.  Caracter\u00edsticas de um MEI:  \u00a0- Um CPF pode ter um MEI;  - Faturamento m\u00e1ximo 81 mil reais;  - N\u00e3o participar como s\u00f3cio, administrador ou titular de outra empresa; - Pode contratar no m\u00e1ximo um empregado;  - N\u00e3o \u00e9 obrigado a ter contador.  Total de\u00a0 CNPJs j\u00e1 registrados no Brasil: 72.372.507 (popula\u00e7\u00e3o). Desses 72 milh\u00f5es 46,61% s\u00e3o CNPJs MEI, isso \u00e9 o equivalente ao total de 33.734.997 Entretanto nem todos os MEIs est\u00e3o ativos, eles podem estar: baixados, suspenso, inapto e nulo.   Entre os MEIs que foram dado baixa os principais motivos foram:   Abaixo temos a distribui\u00e7\u00e3o dos MEI cadastros por estado de acordo com sua situa\u00e7\u00e3o cadastral. Naturalmente S\u00e3o Paulo se destaca nesse gr\u00e1fico e n\u00e3o seria para menos, j\u00e1 que \u00e9 o estado com maior concentra\u00e7\u00e3o populacional.   Pensando que os estados mais populosos se destacariam na quantidade de MEIs cadastrados, foi realizado um c\u00e1lculo da propor\u00e7\u00e3o entre a quantidade de MEIs e o n\u00famero de habitantes de cada estado. Ao analisar esse gr\u00e1fico, percebemos que SP e MG j\u00e1 n\u00e3o ocupam as primeiras posi\u00e7\u00f5es, indicando que o n\u00famero de trabalhadores aut\u00f4nomos em SP e MG \u00e9 menor do que em RS, DF e PR.   Capital Social \u00e9 o valor investido que ser\u00e1 colocado a disposi\u00e7\u00e3o da empresa por cada um dos s\u00f3cios, seja bens financeiros ou bens materiais. Abaixo temos o capital social declarado pelos MEIs."},{"location":"dic_dados_cnpj/","title":"Dicion\u00e1rio de Dados CNPJ","text":""},{"location":"dic_dados_cnpj/#layout-novo-dos-dados-tabelas-descricao","title":"Layout novo dos dados (tabelas + descri\u00e7\u00e3o)","text":"<p>Dicion\u00e1rio de dados</p>"},{"location":"dic_dados_cnpj/#layout-antigo-dos-dados-tabelas-descricao","title":"Layout antigo dos dados (tabelas + descri\u00e7\u00e3o)","text":"<p>Schema CNPJ</p>"},{"location":"extracao_dados/","title":"Extra\u00e7\u00e3o dos dados","text":""},{"location":"extracao_dados/#receitacnpjapi","title":"ReceitaCNPJApi","text":"Nessa sess\u00e3o ser\u00e1 explicado o funcionamento da classe ReceitaCNPJApi, uma classe desenvolvida para fazer a extra\u00e7\u00e3o dos dados de forma distribu\u00edda.    O que \u00e9 a classe ReceitaCNPJApi?   Imagine que voc\u00ea deseja acessar as informa\u00e7\u00f5es da Receita Federal sobre CNPJs. Se voc\u00ea fosse fazer isso manualmente, precisaria ir ao site, pesquisar cada CNPJ um por um, baixar arquivos e at\u00e9 descompact\u00e1-los para ver os dados. Parece trabalhoso, certo?   Bem, a classe ReceitaCNPJApi \u00e9 como um assistente pessoal que faz todo esse trabalho para voc\u00ea! Ela foi criada para facilitar o acesso \u00e0s informa\u00e7\u00f5es do CNPJ dispon\u00edveis na Receita Federal. Em vez de passar por v\u00e1rias etapas manualmente, voc\u00ea pode simplesmente \"conversar\" com esse assistente e pedir a ele para fazer o trabalho.   Como funciona?   Dentro dessa classe, existem v\u00e1rias \"mini-ferramentas\" (que chamamos de m\u00e9todos). Cada uma dessas ferramentas tem uma fun\u00e7\u00e3o espec\u00edfica. Algumas delas ajudam a baixar arquivos, outras descompactam os arquivos baixados, e algumas at\u00e9 mesmo organizam as informa\u00e7\u00f5es para voc\u00ea.   Por exemplo, se voc\u00ea quiser saber quais s\u00e3o os arquivos dispon\u00edveis para baixar, h\u00e1 uma ferramenta que lhe dar\u00e1 uma lista de URLs. Se voc\u00ea quiser baixar um arquivo espec\u00edfico, h\u00e1 outra ferramenta que faz o download e at\u00e9 o descompacta para voc\u00ea.   Como eu posso usar?   Vamos supor que voc\u00ea queria baixar informa\u00e7\u00f5es sobre empresas e munic\u00edpios. Usando essa classe, em vez de ir ao site da Receita Federal, voc\u00ea faria algo assim:   Diga \u00e0 classe que voc\u00ea quer uma lista de URLs de \"Empresas\" e \"Munic\u00edpios\". A classe lhe dar\u00e1 essa lista. Agora, pe\u00e7a \u00e0 classe para baixar o arquivo da primeira URL. A classe far\u00e1 isso e ainda descompactar\u00e1 o arquivo para voc\u00ea. E \u00e9 isso! Sem complica\u00e7\u00f5es, sem ter que navegar por sites ou lidar com arquivos compactados."},{"location":"extracao_dados/#script-da-classe","title":"Script da Classe","text":"<p>ReceitaCNPJApi Teste da Classe</p>"},{"location":"extracao_dados/#exemplo-do-codigo","title":"Exemplo do c\u00f3digo","text":"<pre><code>from ReceitaCNPJApi import ReceitaCNPJApi\nfrom concurrent.futures import ThreadPoolExecutor\n\n\napi = ReceitaCNPJApi()\n# Pode ser uma tabela ou varias\nurls = api.lista_urls_receita('Municipios')\nurls = api.lista_urls_receita('Municipios', 'Cnaes', \n                              'Naturezas', 'Qualificacoes', 'Paises','Motivos')\n\ndef process_url(url):\n    return api.download_and_unzip(url)\n\n# Mais do 3 aconteceu de tomar timeout. Sugiro manter\nwith ThreadPoolExecutor(max_workers=3) as executor:  \n\n    results = list(executor.map(process_url, urls))\n\nfor url, result in zip(urls, results):\n    print(f\"Result for {url}: {result[1]}\")\n</code></pre> <p>Output</p> <pre><code>INFO:ReceitaCNPJApi:Trying to unzip ./temp\\Naturezas.zip\nINFO:ReceitaCNPJApi:File https://dadosabertos.rfb.gov.br/CNPJ/Naturezas.zip has been unzipped successfully to ./output\nINFO:ReceitaCNPJApi:Trying to unzip ./temp\\Cnaes.zip\nINFO:ReceitaCNPJApi:File https://dadosabertos.rfb.gov.br/CNPJ/Cnaes.zip has been unzipped successfully to ./output\nINFO:ReceitaCNPJApi:Trying to unzip ./temp\\Municipios.zip\nINFO:ReceitaCNPJApi:File https://dadosabertos.rfb.gov.br/CNPJ/Municipios.zip has been unzipped successfully to ./output\nINFO:ReceitaCNPJApi:Trying to unzip ./temp\\Qualificacoes.zip\nINFO:ReceitaCNPJApi:File https://dadosabertos.rfb.gov.br/CNPJ/Qualificacoes.zip has been unzipped successfully to ./output\nINFO:ReceitaCNPJApi:Trying to unzip ./temp\\Paises.zip\nINFO:ReceitaCNPJApi:File https://dadosabertos.rfb.gov.br/CNPJ/Paises.zip has been unzipped successfully to ./output\nINFO:ReceitaCNPJApi:Trying to unzip ./temp\\Motivos.zip\nINFO:ReceitaCNPJApi:File https://dadosabertos.rfb.gov.br/CNPJ/Motivos.zip has been unzipped successfully to ./output\nResult for https://dadosabertos.rfb.gov.br/CNPJ/Municipios.zip: Success\nResult for https://dadosabertos.rfb.gov.br/CNPJ/Cnaes.zip: Success\nResult for https://dadosabertos.rfb.gov.br/CNPJ/Naturezas.zip: Success\nResult for https://dadosabertos.rfb.gov.br/CNPJ/Qualificacoes.zip: Success\nResult for https://dadosabertos.rfb.gov.br/CNPJ/Paises.zip: Success\nResult for https://dadosabertos.rfb.gov.br/CNPJ/Motivos.zip: Success\n</code></pre>"},{"location":"mei/","title":"Sobre MEI","text":"O Microempreendedor Individual, mais conhecido pela sigla MEI, \u00e9 uma figura jur\u00eddica criada no Brasil em 2008 com a finalidade de formalizar trabalhadores aut\u00f4nomos e pequenos empres\u00e1rios. Esta categoria simplifica e incentiva a formaliza\u00e7\u00e3o de pequenos neg\u00f3cios e atividades aut\u00f4nomas, oferecendo um processo de registro simplificado, tributa\u00e7\u00e3o reduzida e acesso a benef\u00edcios previdenci\u00e1rios.   Para se enquadrar como MEI, o empreendedor n\u00e3o pode ter faturamento anual superior a um limite estabelecido pela legisla\u00e7\u00e3o (em 2022, esse limite era de R$ 81.000,00 por ano). Al\u00e9m disso, o MEI n\u00e3o pode ser s\u00f3cio, administrador ou titular de outra empresa e s\u00f3 \u00e9 permitido ter no m\u00e1ximo um empregado que receba um sal\u00e1rio m\u00ednimo ou o piso da categoria.   O processo de formaliza\u00e7\u00e3o como MEI \u00e9 gratuito e pode ser realizado online, diretamente no Portal do Empreendedor. Ap\u00f3s a formaliza\u00e7\u00e3o, o empreendedor passa a ter obriga\u00e7\u00f5es como a entrega da Declara\u00e7\u00e3o Anual do Simples Nacional (DASN-SIMEI) e o pagamento mensal do DAS.  <p>Vantagens de ser MEI, destacam-se:</p> <ul> <li> Tributa\u00e7\u00e3o simplificada e reduzida, com pagamento de valores fixos mensais atrav\u00e9s do Documento de Arrecada\u00e7\u00e3o Simplificada (DAS);</li> <li> Acesso a benef\u00edcios previdenci\u00e1rios, como aposentadoria, aux\u00edlio-doen\u00e7a, sal\u00e1rio-maternidade, entre outros;</li> <li> Facilidade para abertura de conta banc\u00e1ria, solicita\u00e7\u00e3o de cr\u00e9ditos e emiss\u00e3o de notas fiscais;</li> <li> Registro no Cadastro Nacional de Pessoas Jur\u00eddicas (CNPJ), o que proporciona mais credibilidade ao neg\u00f3cio.</li> </ul>  Tendo em vista as informa\u00e7\u00f5es podemos concluir que o Microempreendedor Individual pode atingir uma m\u00e9dia mensal salarial de at\u00e9 R$ 6.750,00. Grande parte dos MEIs s\u00e3o pequenos neg\u00f3cios e trabalhadores aut\u00f4nomos, pois sua cria\u00e7\u00e3o buscou facilitar a formaliza\u00e7\u00e3o destes profissionais e de pequenos estabelecimentos. Ao se formalizar, o MEI obt\u00e9m um CNPJ, o que facilita a abertura de conta banc\u00e1ria, pedido de empr\u00e9stimos e emiss\u00e3o de notas fiscais.   <p>Quais s\u00e3o os dados disponiveis de MEI?</p> <ul> <li> Nome</li> <li> Porte</li> <li> Localiza\u00e7\u00e3o </li> <li> E-mail</li> <li> Telefone</li> <li> Sexo</li> <li> CPF (em alguns casos)</li> <li> Latitude e Longitude</li> </ul> <p>Curiosidades</p> <ul> <li>O MEI pode ter uma filial, al\u00e9m da matriz;</li> <li>O MEI pode ter, no m\u00e1ximo, um empregado contratado;</li> <li>O MEI n\u00e3o pode ser s\u00f3cio;</li> <li>O MEI \u00e9 isento de tributos federais como IRPJ, PIS, Cofins, IPI e CSLL;</li> <li>O MEI n\u00e3o pode participar como titular, s\u00f3cio ou administrador de outra empresa.</li> </ul>"},{"location":"schema/","title":"Schema dos dados","text":""},{"location":"tratamento_dados_cnpj/","title":"Tratamento dos dados","text":""},{"location":"tratamento_dados_cnpj/#classe-receitalt","title":"Classe ReceitaLT","text":"Esta classe fornece ferramentas especializadas para a manipula\u00e7\u00e3o e an\u00e1lise de dados da Receita Federal do Brasil.   M\u00e9todos:  detect_encoding(file_pattern_or_path, num_bytes=10000)  Retorno: Dicion\u00e1rio com caminhos de arquivos e suas respectivas codifica\u00e7\u00f5es.   read_data(schema_name, base_path=opcional)  Retorno: DataFrame do Spark consolidado dos arquivos.   Descri\u00e7\u00e3o:  - Detecta a codifica\u00e7\u00e3o dos arquivos.   - L\u00ea m\u00faltiplos arquivos CSV.  - Assimila arquivos com delimitador \";\", sem cabe\u00e7alho e campos delimitados por aspas.   geocode_udf(address)  Retorno: Dicion\u00e1rio com 'latitude' e 'longitude'.  Descri\u00e7\u00e3o:   - Utiliza a fun\u00e7\u00e3o interna geocode_address para obter coordenadas.  Retorna um tipo de dado complexo (Struct).   process_estabelecimentos(df)  Retorno: DataFrame processado e enriquecido.  Descri\u00e7\u00e3o:  - L\u00ea dataframes adicionais (pa\u00edses, munic\u00edpios, cnaes, motivos).  - Renomeia colunas.  - Enriquece dados.  - Processa colunas de e-mail e datas.  - Deriva novas colunas. - Valida endere\u00e7os de e-mail. - Geocodifica endere\u00e7os e CEPs. - Corrige provedores de e-mail.  process_empresas(df)  Retorno: DataFrame processado e enriquecido.  Descri\u00e7\u00e3o:  - L\u00ea dataframes adicionais (naturezas jur\u00eddicas e qualifica\u00e7\u00f5es).  - Renomeia colunas.  - Enriquece dados.  - Processa a coluna 'NOME_EMPRESA' e extrai CPFs.  - Deriva nova coluna com porte da empresa.  - Criptografa CPFs.   process_simples(df)  Retorno: DataFrame processado.  Descri\u00e7\u00e3o:  - Converte colunas de data.  - Seleciona apenas colunas relevantes.   save_df(df, path, num_partitions=1, file_format=\"parquet\")  Descri\u00e7\u00e3o:  - Salva DataFrame no caminho especificado.  - Especifica o n\u00famero de parti\u00e7\u00f5es e o formato do arquivo.   download_and_extract_names(save_base_path=opcional)   Descri\u00e7\u00e3o:   - Cria diret\u00f3rio para armazenar o arquivo baixado.   - Realiza o download do arquivo \"nomes.csv.gz\" do dataset genero-nomes no Brasil.io.   - Extrai o conte\u00fado do arquivo .gz.   - Exclui o arquivo .gz original, mantendo apenas o arquivo CSV extra\u00eddo.    process_meis(df, save_base_path=opcional, file_name=opcional)   Retorno: DataFrame processado ap\u00f3s todas as transforma\u00e7\u00f5es e jun\u00e7\u00f5es.   Descri\u00e7\u00e3o:  - Realiza jun\u00e7\u00e3o com DataFrames de 'naturezas' e 'qualifica\u00e7\u00f5es'.  - Manipula e extrai dados de CPF.  - Mapeia e cria a coluna \"NM_PORTE\" para especificar o porte da empresa.  - Criptografa a coluna de CPF.  - Filtra baseado na probabilidade do nome ser um CPF v\u00e1lido.  - L\u00ea um conjunto de dados de nomes e processa a coluna 'alternative_names'.  - Extrai o primeiro nome da coluna 'NOME_EMPRESA' e realiza jun\u00e7\u00e3o para categorizar o primeiro nome.   process_socios(df, save_base_path=opcional, file_name=opcional)  Retorno: DataFrame processado ap\u00f3s todas as transforma\u00e7\u00f5es e jun\u00e7\u00f5es.  Descri\u00e7\u00e3o:  -Realiza jun\u00e7\u00e3o com DataFrames de 'pa\u00edses'.   -Mapeia e cria colunas \"NM_FAIXA_ETARIA\" e \"NM_IDENTIFICADOR_SOCIO\".   -Renomeia e junta com DataFrame de qualifica\u00e7\u00f5es.   -Converte coluna de data \"DATA_ENTRADA_SOCIEDADE\".  -L\u00ea e processa um conjunto de dados de nomes, segmentando e selecionando colunas relevantes.  -Extrai o primeiro nome da coluna 'NOME_SOCIO_RAZAO_SOCIAL' e realiza jun\u00e7\u00e3o para categorizar esse nome.   geocode_address(address) Retorno: Um par (tuple) contendo latitude e longitude.  Descri\u00e7\u00e3o: - Geocodifica um endere\u00e7o, convertendo-o em coordenadas de latitude e longitude. Notas: - Utiliza o servi\u00e7o Nominatim para realizar a geocodifica\u00e7\u00e3o. - Tem um limitador de taxa para garantir que n\u00e3o se excedam os limites de requisi\u00e7\u00f5es por segundo do servi\u00e7o."},{"location":"tratamento_dados_cnpj/#script-da-classe","title":"Script da Classe","text":"<p>ReceitaLT Teste da Classe</p>"},{"location":"tratamento_dados_cnpj/#exemplo-do-codigo","title":"Exemplo do c\u00f3digo","text":""},{"location":"tratamento_dados_cnpj/#exemplo-1","title":"Exemplo 1","text":"<pre><code>from ReceitaLT import ReceitaLT\nfrom pyspark.sql import SparkSession\nimport findspark\n\nspark = (SparkSession.builder\n    .master(\"local[*]\")  \n    .config('spark.sql.repl.eagerEval.enabled', True)\n    .config(\"spark.sql.repl.eagerEval.maxNumRows\", 10)\n    .appName('dataset_cnpj')\n    .getOrCreate())\n\nreceitaLT_processor = ReceitaLT(spark) \n\ndf = receitaLT_processor.read_data(schema_name='empresas').cache()\ndf_mei = receitaLT_processor.process_mei(df)\n</code></pre> <p>Output</p> <pre><code>INFO:ReceitaLT:Detected encodings: {'./output\\\\Empresas\\\\Empresas0.csv': 'ascii', \n'./output\\\\Empresas\\\\Empresas1.csv': 'ascii', \n'./output\\\\Empresas\\\\Empresas2.csv': 'ascii', './output\\\\Empresas\\\\Empresas3.csv': 'ascii',\n './output\\\\Empresas\\\\Empresas4.csv': 'ascii', './output\\\\Empresas\\\\Empresas5.csv': 'ascii', \n './output\\\\Empresas\\\\Empresas6.csv': 'ascii',  './output\\\\Empresas\\\\Empresas7.csv': 'ascii',\n  './output\\\\Empresas\\\\Empresas8.csv': 'ascii',  './output\\\\Empresas\\\\Empresas9.csv': 'ascii'}\nINFO:ReceitaLT:Detected encodings: {'./output\\\\Naturezas\\\\Naturezas.csv': 'ISO-8859-1'}\nINFO:ReceitaLT:Detected encodings: {'./output\\\\Qualificacoes\\\\Qualificacoes.csv': 'ISO-8859-1'}\n</code></pre> <p></p>"},{"location":"tratamento_dados_cnpj/#exemplo-2","title":"Exemplo 2","text":"<pre><code>from ReceitaLT import ReceitaLT\nfrom pyspark.sql import SparkSession\nimport findspark\n\nspark = (SparkSession.builder\n    .master(\"local[*]\")  \n    .config('spark.sql.repl.eagerEval.enabled', True)\n    .config(\"spark.sql.repl.eagerEval.maxNumRows\", 10)\n    .appName('dataset_cnpj')\n    .getOrCreate())\n\nreceitaLT_processor = ReceitaLT(spark) \n\ndf = receitaLT_processor.read_data(schema_name='estabelecimentos').cache()\ndf_estabelecimentos = receitaLT_processor.process_estabelecimentos(df)\n</code></pre> <p>Output</p> <pre><code>INFO:ReceitaLT:Detected encodings: {'./output\\\\Estabelecimentos\\\\Estabelecimentos.csv': 'ascii', './output\\\\Estabelecimentos\\\\Estabelecimentos0.csv': 'ascii',\n './output\\\\Estabelecimentos\\\\Estabelecimentos1.csv': 'ascii', './output\\\\Estabelecimentos\\\\Estabelecimentos2.csv': 'ascii', \n './output\\\\Estabelecimentos\\\\Estabelecimentos3.csv': 'ascii',  './output\\\\Estabelecimentos\\\\Estabelecimentos4.csv': 'ascii', \n './output\\\\Estabelecimentos\\\\Estabelecimentos5.csv': 'ascii', './output\\\\Estabelecimentos\\\\Estabelecimentos6.csv': 'ascii',\n './output\\\\Estabelecimentos\\\\Estabelecimentos7.csv': 'ascii', './output\\\\Estabelecimentos\\\\Estabelecimentos8.csv': 'ascii', \n './output\\\\Estabelecimentos\\\\Estabelecimentos9.csv': 'ISO-8859-1'}\nINFO:ReceitaLT:Detected encodings: {'./output\\\\Paises\\\\Paises.csv': 'ISO-8859-1'}\nINFO:ReceitaLT:Detected encodings: {'./output\\\\Municipios\\\\Municipios.csv': 'ascii'}\nINFO:ReceitaLT:Detected encodings: {'./output\\\\Cnaes\\\\Cnaes.csv': 'ISO-8859-1'}\nINFO:ReceitaLT:Detected encodings: {'./output\\\\Motivos\\\\Motivos.csv': 'ascii'}\n</code></pre> <p> continua\u00e7\u00e3o da tabela  continua\u00e7\u00e3o da tabela </p>"},{"location":"versionamento_projeto/","title":"Controle de vers\u00e3o e ferramentas no projeto","text":"Vers\u00e3o Data da Atualiza\u00e7\u00e3o o que foi modificado 0.1 17/10/2023 Deploy do MVP do projeto, extra\u00e7\u00e3o, tratamento e an\u00e1lise do MEI <p>Ferramentas Utilizadas na Vers\u00e3o Atual do Projeto</p> <ul> <li>Python</li> <li>Pyspark</li> <li>Jupyter Lab</li> <li>Plotly</li> <li>MKdocs</li> </ul> <p></p>"}]}